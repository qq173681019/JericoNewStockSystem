<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIAPS - ËÇ°Á•®Êô∫ËÉΩÂàÜÊûêÈ¢ÑÊµãÁ≥ªÁªü</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <!-- Sidebar Navigation -->
    <nav class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <span>üìà</span>
                <span>SIAPS</span>
            </div>
            <button class="sidebar-toggle" id="sidebarToggle">
                <span>‚ò∞</span>
            </button>
        </div>
        
        <ul class="nav-menu">
            <li class="nav-item active" data-view="prediction">
                <span>üìä</span>
                <span>ËÇ°Á•®È¢ÑÊµã</span>
            </li>
            <li class="nav-item" data-view="watchlist">
                <span>üëÅÔ∏è</span>
                <span>ËßÇÊµãÊ±†</span>
            </li>
            <li class="nav-item" data-view="history">
                <span>üïê</span>
                <span>ÂéÜÂè≤ËÆ∞ÂΩï</span>
            </li>
            <li class="nav-item" data-view="analytics">
                <span>üìà</span>
                <span>Êï∞ÊçÆÂàÜÊûê</span>
            </li>
            <li class="nav-item" data-view="settings">
                <span>‚öôÔ∏è</span>
                <span>ËÆæÁΩÆ</span>
            </li>
        </ul>
        
        <div class="sidebar-footer">
            <div class="theme-toggle">
                <span>üåô</span>
                <label class="switch">
                    <input type="checkbox" id="themeToggle">
                    <span class="slider"></span>
                </label>
                <span>‚òÄÔ∏è</span>
            </div>
            <div class="version-info">v1.0.0</div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content" id="mainContent">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <button class="mobile-menu-toggle" id="mobileMenuToggle">
                    <span>‚ò∞</span>
                </button>
                <h1 class="page-title" id="pageTitle">ËÇ°Á•®È¢ÑÊµã</h1>
            </div>
            <div class="header-right">
                <div class="search-bar">
                    <span>üîç</span>
                    <input type="text" placeholder="ÊêúÁ¥¢ËÇ°Á•®‰ª£Á†Å..." id="quickSearch">
                </div>
                <div class="user-menu">
                    <span>üë§</span>
                </div>
            </div>
        </header>

        <!-- View Container -->
        <div class="view-container" id="viewContainer">
            <!-- Prediction View -->
            <div class="view active" id="predictionView">
                <div class="card">
                    <div class="card-header">
                        <h2>ËÇ°Á•®ÂàÜÊûêÈ¢ÑÊµã</h2>
                        <p class="card-subtitle">ËæìÂÖ•ËÇ°Á•®‰ª£Á†ÅËé∑ÂèñÊô∫ËÉΩÂàÜÊûêÂíåÈ¢ÑÊµã</p>
                    </div>
                    <div class="card-body">
                        <div class="stock-input-section">
                            <div class="input-group">
                                <input type="text" id="stockCode" placeholder="ËæìÂÖ•ËÇ°Á•®‰ª£Á†ÅÔºå‰æãÂ¶Ç: 000001" class="stock-input">
                                <button class="btn btn-primary" id="predictBtn">
                                    <span>‚ú®</span>
                                    ÂºÄÂßãÈ¢ÑÊµã
                                </button>
                            </div>
                            <div class="timeframe-selector">
                                <label>È¢ÑÊµãÊó∂Èó¥Ê°ÜÊû∂:</label>
                                <div class="timeframe-buttons">
                                    <button class="btn btn-timeframe" data-timeframe="1hour">1Â∞èÊó∂</button>
                                    <button class="btn btn-timeframe active" data-timeframe="3day">3Â§©</button>
                                    <button class="btn btn-timeframe" data-timeframe="30day">30Â§©</button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="prediction-results" id="predictionResults" style="display: none;">
                            <div class="stock-info-header">
                                <div class="stock-code-name">
                                    <span class="stock-code" id="resultStockCode">--</span>
                                    <span class="stock-name" id="resultStockName">--</span>
                                    <span class="current-price" id="resultCurrentPrice">--</span>
                                    <button class="btn btn-add-watchlist" id="addToWatchlistFromPrediction" title="Ê∑ªÂä†Âà∞ËßÇÊµãÊ±†">
                                        <span>‚ûï</span>
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Multi-timeframe prediction cards -->
                            <div class="multi-timeframe-results" id="multiTimeframeResults">
                                <div class="timeframe-card" data-timeframe="1hour">
                                    <div class="timeframe-header">
                                        <h3>‚è±Ô∏è 1Â∞èÊó∂È¢ÑÊµã</h3>
                                        <span class="timeframe-status" id="status1hour">--</span>
                                    </div>
                                    <div class="timeframe-content">
                                        <div class="prediction-value">
                                            <span class="value-label">È¢ÑÊµã‰ª∑Ê†º</span>
                                            <span class="value-number" id="price1hour">--</span>
                                        </div>
                                        <div class="prediction-change">
                                            <span class="change-label">È¢ÑÊúüÂèòÂåñ</span>
                                            <span class="change-number" id="change1hour">--</span>
                                        </div>
                                        <div class="prediction-confidence">
                                            <span class="confidence-label">‰ø°ÂøÉÂ∫¶</span>
                                            <span class="confidence-number" id="confidence1hour">--</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="timeframe-card" data-timeframe="3day">
                                    <div class="timeframe-header">
                                        <h3>üìÖ 3Â§©È¢ÑÊµã</h3>
                                        <span class="timeframe-status" id="status3day">--</span>
                                    </div>
                                    <div class="timeframe-content">
                                        <div class="prediction-value">
                                            <span class="value-label">È¢ÑÊµã‰ª∑Ê†º</span>
                                            <span class="value-number" id="price3day">--</span>
                                        </div>
                                        <div class="prediction-change">
                                            <span class="change-label">È¢ÑÊúüÂèòÂåñ</span>
                                            <span class="change-number" id="change3day">--</span>
                                        </div>
                                        <div class="prediction-confidence">
                                            <span class="confidence-label">‰ø°ÂøÉÂ∫¶</span>
                                            <span class="confidence-number" id="confidence3day">--</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="timeframe-card" data-timeframe="30day">
                                    <div class="timeframe-header">
                                        <h3>üìà 30Â§©È¢ÑÊµã</h3>
                                        <span class="timeframe-status" id="status30day">--</span>
                                    </div>
                                    <div class="timeframe-content">
                                        <div class="prediction-value">
                                            <span class="value-label">È¢ÑÊµã‰ª∑Ê†º</span>
                                            <span class="value-number" id="price30day">--</span>
                                        </div>
                                        <div class="prediction-change">
                                            <span class="change-label">È¢ÑÊúüÂèòÂåñ</span>
                                            <span class="change-number" id="change30day">--</span>
                                        </div>
                                        <div class="prediction-confidence">
                                            <span class="confidence-label">‰ø°ÂøÉÂ∫¶</span>
                                            <span class="confidence-number" id="confidence30day">--</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="results-grid">
                                <div class="result-card">
                                    <div class="result-icon">
                                        <span>üìà</span>
                                    </div>
                                    <div class="result-content">
                                        <h3>Áü≠ÊúüÈ¢ÑÊµã</h3>
                                        <p class="result-value" id="shortTermPrediction">--</p>
                                        <p class="result-label">È¢ÑÊµãÊ∂®Ë∑å</p>
                                    </div>
                                </div>
                                <div class="result-card">
                                    <div class="result-icon">
                                        <span>üìÖ</span>
                                    </div>
                                    <div class="result-content">
                                        <h3>‰∏≠ÊúüÈ¢ÑÊµã</h3>
                                        <p class="result-value" id="mediumTermPrediction">--</p>
                                        <p class="result-label">3‰∏™ÊúàÁõÆÊ†á‰ª∑</p>
                                    </div>
                                </div>
                                <div class="result-card">
                                    <div class="result-icon">
                                        <span>üí°</span>
                                    </div>
                                    <div class="result-content">
                                        <h3>Êìç‰ΩúÂª∫ËÆÆ</h3>
                                        <p class="result-value" id="tradingAdvice">--</p>
                                        <p class="result-label">‰∫§ÊòìÂª∫ËÆÆ</p>
                                    </div>
                                </div>
                                <div class="result-card">
                                    <div class="result-icon">
                                        <span>üéØ</span>
                                    </div>
                                    <div class="result-content">
                                        <h3>ÂáÜÁ°ÆÁéá</h3>
                                        <p class="result-value" id="accuracy">--</p>
                                        <p class="result-label">Ê®°ÂûãÂáÜÁ°ÆÁéá</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="chart-container">
                                <h3>‰ª∑Ê†ºËµ∞ÂäøÂõæ</h3>
                                <canvas id="priceChart"></canvas>
                            </div>
                            
                            <div class="technical-indicators">
                                <h3>ÊäÄÊúØÊåáÊ†á</h3>
                                <div class="indicators-grid">
                                    <div class="indicator">
                                        <span class="indicator-name">RSI</span>
                                        <span class="indicator-value" id="rsi">--</span>
                                    </div>
                                    <div class="indicator">
                                        <span class="indicator-name">MACD</span>
                                        <span class="indicator-value" id="macd">--</span>
                                    </div>
                                    <div class="indicator">
                                        <span class="indicator-name">KDJ</span>
                                        <span class="indicator-value" id="kdj">--</span>
                                    </div>
                                    <div class="indicator">
                                        <span class="indicator-name">MA5</span>
                                        <span class="indicator-value" id="ma5">--</span>
                                    </div>
                                    <div class="indicator">
                                        <span class="indicator-name">MA20</span>
                                        <span class="indicator-value" id="ma20">--</span>
                                    </div>
                                    <div class="indicator">
                                        <span class="indicator-name">BOLL</span>
                                        <span class="indicator-value" id="boll">--</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Watchlist View -->
            <div class="view" id="watchlistView">
                <div class="card">
                    <div class="card-header">
                        <h2>ËßÇÊµãÊ±†ÁÆ°ÁêÜ</h2>
                        <div class="header-buttons">
                            <button class="btn btn-secondary" id="refreshWatchlistBtn">
                                <span>üîÑ</span>
                                Âà∑Êñ∞Êï∞ÊçÆ
                            </button>
                            <button class="btn btn-primary" id="addStockBtn">
                                <span>‚ûï</span>
                                Ê∑ªÂä†ËÇ°Á•®
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="watchlist-table">
                            <table id="watchlistTable">
                                <thead>
                                    <tr>
                                        <th>ËÇ°Á•®‰ª£Á†Å</th>
                                        <th>ËÇ°Á•®ÂêçÁß∞</th>
                                        <th>ÂΩìÂâç‰ª∑Ê†º</th>
                                        <th>Ê∂®Ë∑åÂπÖ</th>
                                        <th>Áä∂ÊÄÅ</th>
                                        <th>Êìç‰Ωú</th>
                                    </tr>
                                </thead>
                                <tbody id="watchlistBody">
                                    <!-- Data loaded dynamically -->
                                    <tr>
                                        <td colspan="6" style="text-align: center; color: var(--text-secondary);">
                                            Âä†ËΩΩ‰∏≠...
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- History View -->
            <div class="view" id="historyView">
                <div class="card">
                    <div class="card-header">
                        <h2>È¢ÑÊµãÂéÜÂè≤ËÆ∞ÂΩï</h2>
                        <div class="filter-controls">
                            <select class="filter-select">
                                <option>ÂÖ®ÈÉ®ËÆ∞ÂΩï</option>
                                <option>‰ªäÂ§©</option>
                                <option>Êú¨Âë®</option>
                                <option>Êú¨Êúà</option>
                            </select>
                            <button class="btn btn-danger" id="clearHistoryBtn">
                                <span>üóëÔ∏è</span>
                                Ê∏ÖÁ©∫ÂéÜÂè≤ËÆ∞ÂΩï
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="history-stats">
                            <div class="stat-card">
                                <span>üìä</span>
                                <div>
                                    <h3>156</h3>
                                    <p>ÊÄªÈ¢ÑÊµãÊ¨°Êï∞</p>
                                </div>
                            </div>
                            <div class="stat-card">
                                <span>‚úÖ</span>
                                <div>
                                    <h3>78.5%</h3>
                                    <p>ÂáÜÁ°ÆÁéá</p>
                                </div>
                            </div>
                            <div class="stat-card">
                                <span>üèÜ</span>
                                <div>
                                    <h3>45</h3>
                                    <p>ÁõàÂà©Ê¨°Êï∞</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="history-table">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Êó∂Èó¥</th>
                                        <th>ËÇ°Á•®‰ª£Á†Å</th>
                                        <th>È¢ÑÊµãÁ±ªÂûã</th>
                                        <th>È¢ÑÊµãÁªìÊûú</th>
                                        <th>ÂÆûÈôÖÁªìÊûú</th>
                                        <th>ÂáÜÁ°ÆÊÄß</th>
                                        <th>Êìç‰Ωú</th>
                                        <th>ËßÇÊµãÊ±†</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>2026-01-30 14:30</td>
                                        <td>000001</td>
                                        <td>Áü≠Êúü</td>
                                        <td class="positive">+2.5%</td>
                                        <td class="positive">+2.3%</td>
                                        <td><span class="badge badge-success">ÂáÜÁ°Æ</span></td>
                                        <td><button class="btn-icon"><span>üëÅÔ∏è</span></button></td>
                                        <td><button class="btn-icon btn-add" onclick="addToWatchlistFromHistory('000001')" title="Ê∑ªÂä†Âà∞ËßÇÊµãÊ±†"><span>‚ûï</span></button></td>
                                    </tr>
                                    <tr>
                                        <td>2026-01-29 10:15</td>
                                        <td>600036</td>
                                        <td>‰∏≠Êúü</td>
                                        <td>¬•38.50</td>
                                        <td>ËøõË°å‰∏≠</td>
                                        <td><span class="badge badge-info">ÂæÖÈ™åËØÅ</span></td>
                                        <td><button class="btn-icon"><span>üëÅÔ∏è</span></button></td>
                                        <td><button class="btn-icon btn-add" onclick="addToWatchlistFromHistory('600036')" title="Ê∑ªÂä†Âà∞ËßÇÊµãÊ±†"><span>‚ûï</span></button></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Analytics View -->
            <div class="view" id="analyticsView">
                <div class="card">
                    <div class="card-header">
                        <h2>Êï∞ÊçÆÂàÜÊûê</h2>
                        <button class="btn btn-primary" id="refreshAnalyticsBtn" onclick="refreshAnalytics()">
                            üîÑ Âà∑Êñ∞Êï∞ÊçÆ
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="analytics-grid">
                            <div class="analytics-card">
                                <h3>ÊùøÂùóÁÉ≠Â∫¶ÂàÜÊûê <span id="sectorSource" class="source-tag"></span></h3>
                                <canvas id="sectorChart"></canvas>
                                <div id="sectorDetails" class="sector-details"></div>
                            </div>
                            <div class="analytics-card">
                                <h3>Â∏ÇÂú∫ÊÉÖÁª™ÊåáÊ†á</h3>
                                <canvas id="sentimentChart"></canvas>
                            </div>
                        </div>
                        
                        <!-- ÊùøÂùóÁÉ≠ÂäõÂõæ -->
                        <div class="heatmap-section">
                            <div class="card-header">
                                <div class="heatmap-title-row">
                                    <h3>ÂÖ®Â∏ÇÂú∫ÊùøÂùóÁÉ≠ÂäõÂõæ <span id="heatmapCount" class="count-tag"></span></h3>
                                    <div class="view-toggle-btns">
                                        <button class="toggle-btn active" id="gridViewBtn" onclick="switchHeatmapView('grid')">
                                            ‚äû ÁΩëÊ†º
                                        </button>
                                        <button class="toggle-btn" id="treemapViewBtn" onclick="switchHeatmapView('treemap')">
                                            ‚ñ¶ Ê†ëÂõæ
                                        </button>
                                    </div>
                                </div>
                                 <div class="heatmap-legend">
                                    <div style="font-size: 0.7rem; color: var(--text-secondary); margin-bottom: 0.5rem;">
                                        <strong>Áü©ÂΩ¢Â§ßÂ∞è:</strong> ÊùøÂùóÂ∏ÇÂú∫ÊùÉÈáçÔºà‰∏™ËÇ°Êï∞Èáè√óÁÉ≠Â∫¶ÊåáÊï∞Ôºâ| <strong>È¢úËâ≤:</strong> Ê∂®Ë∑åÂπÖ
                                    </div>
                                    <span class="legend-item"><span class="legend-color" style="background: #8B0000;"></span>‚â•10%</span>
                                    <span class="legend-item"><span class="legend-color" style="background: #B22222;"></span>8-10%</span>
                                    <span class="legend-item"><span class="legend-color" style="background: #DC143C;"></span>5-8%</span>
                                    <span class="legend-item"><span class="legend-color" style="background: #FF6B6B;"></span>2-5%</span>
                                    <span class="legend-item"><span class="legend-color" style="background: #FFB3B3;"></span>1-2%</span>
                                    <span class="legend-item"><span class="legend-color" style="background: #FFFFCC;"></span>-1%~1%</span>
                                    <span class="legend-item"><span class="legend-color" style="background: #C8E6C9;"></span>-3%~-1%</span>
                                    <span class="legend-item"><span class="legend-color" style="background: #81C784;"></span>-5%~-3%</span>
                                    <span class="legend-item"><span class="legend-color" style="background: #43A047;"></span>-8%~-5%</span>
                                    <span class="legend-item"><span class="legend-color" style="background: #1B5E20;"></span>‚â§-8%</span>
                                </div>
                            </div>
                            <div id="sectorHeatmap" class="sector-heatmap"></div>
                            <div id="sectorTreemap" class="sector-treemap" style="display: none;"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings View -->
            <div class="view" id="settingsView">
                <div class="card">
                    <div class="card-header">
                        <h2>Á≥ªÁªüËÆæÁΩÆ</h2>
                    </div>
                    <div class="card-body">
                        <div class="settings-section">
                            <h3>ÈÄöÁü•ËÆæÁΩÆ</h3>
                            <div class="setting-item">
                                <label>
                                    <input type="checkbox" checked>
                                    <span>‰ª∑Ê†ºÈ¢ÑË≠¶ÈÄöÁü•</span>
                                </label>
                            </div>
                            <div class="setting-item">
                                <label>
                                    <input type="checkbox" checked>
                                    <span>È¢ÑÊµãÂÆåÊàêÈÄöÁü•</span>
                                </label>
                            </div>
                        </div>
                        
                        <div class="settings-section">
                            <h3>Êï∞ÊçÆÊ∫êËÆæÁΩÆ</h3>
                            <div class="setting-item">
                                <label>ÈªòËÆ§Êï∞ÊçÆÊ∫ê</label>
                                <select class="setting-select">
                                    <option selected>Êñ∞Êµ™Ë¥¢Áªè</option>
                                    <option>‰∏úÊñπË¥¢ÂØå</option>
                                    <option>AKShare</option>
                                    <option>TuShare</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="settings-section">
                            <h3>ÂÖ≥‰∫é</h3>
                            <p><strong>SIAPS</strong> - ËÇ°Á•®Êô∫ËÉΩÂàÜÊûêÈ¢ÑÊµãÁ≥ªÁªü</p>
                            <p style="color: var(--text-secondary); font-size: 0.9em; margin-left: 1em;">
                                <strong>S</strong>tock <strong>I</strong>ntelligent <strong>A</strong>nalysis & <strong>P</strong>rediction <strong>S</strong>ystem<br>
                                (ËÇ°Á•®Êô∫ËÉΩÂàÜÊûê‰∏éÈ¢ÑÊµãÁ≥ªÁªü)
                            </p>
                            <p>ÁâàÊú¨: 1.0.0</p>
                            <p>Âü∫‰∫éÊú∫Âô®Â≠¶‰π†ÂíåÊ∑±Â∫¶Â≠¶‰π†ÁöÑÊô∫ËÉΩÈ¢ÑÊµãÁ≥ªÁªü</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Add Stock Modal -->
    <div class="modal-overlay" id="addStockModal" style="display: none;">
        <div class="modal">
            <div class="modal-header">
                <h3>Ê∑ªÂä†ËÇ°Á•®Âà∞ËßÇÊµãÊ±†</h3>
                <button class="modal-close" onclick="closeAddStockModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>ËÇ°Á•®‰ª£Á†Å <span class="required">*</span></label>
                    <input type="text" id="modalStockCode" placeholder="‰æãÂ¶Ç: 000001" class="form-input">
                    <small class="form-hint">Ê∑ªÂä†ÂêéÂèØÂú®È¢ÑÊµãÈ°µÈù¢ËøõË°åËÇ°Á•®ÂàÜÊûê</small>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeAddStockModal()">ÂèñÊ∂à</button>
                <button class="btn btn-primary" onclick="submitAddStock()">Ê∑ªÂä†</button>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner"></div>
        <p>Ê≠£Âú®ÂàÜÊûê‰∏≠...</p>
    </div>

    <!-- Scripts -->
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
